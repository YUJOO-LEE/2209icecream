<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가위 바위 보</title>
    <style>
        #computer {
            width: 170px;
            height: 200px;
        }
    </style>
</head>
<body>
    <main>
        <div id="computer"></div>
        <div>
            <button id="scissors">가위</button>
            <button id="rock">바위</button>
            <button id="paper">보</button>
        </div>
        <div id="msg"></div>
        <div>총 점수는 <span id="score">0</span>점 입니다.</div>
    </main>
</body>
<script>
    const $computer = document.querySelector('#computer');
    const $msg = document.querySelector('#msg');
    const $score = document.querySelector('#score');
    const $scissors = document.querySelector('#scissors');
    const $rock = document.querySelector('#rock');
    const $paper = document.querySelector('#paper');
    const imgUrl = './rsp.png';
    $computer.style.background = `url(${imgUrl}) 1px 0 no-repeat`; //바위 -230px, 보 -438px
    $computer.style.backgroundSize = 'auto 200px';

    const rspX = {  //가위바위보 이미지 가로축 위치
        scissors : '1px',
        rock : '-230px',
        paper : '-437px',
    }

    let computerChoice = 'scissors'; //컴퓨터 선택값 기본세팅 : 가위
    let myChoice;  //사용자 선택값
    let toggleBtn = true;   //버튼 작동 여부 : 기본 true

    const changeHand = () => {  //가위바위보 순환시키기
        if (computerChoice === 'scissors') { //가위일때 바위로
            computerChoice = 'rock';
        } else if (computerChoice === 'rock'){   //바위일때 보로
            computerChoice = 'paper';
        } else if (computerChoice === 'paper'){  //보일때 가위로
            computerChoice = 'scissors';
        }
        $computer.style.backgroundPositionX = rspX[computerChoice]; //이미지 선택값에 맞게 바꿔주기
        toggleBtn = true;   //버튼 작동
    }

    const checkGame = () => {   //컴퓨터 값과 사용자 선택값 비교
        if (myChoice === computerChoice) {
            $msg.textContent = '비겼습니다.';
        } else if ((myChoice === 'scissors' && computerChoice === 'paper') ||   //승리조건
            (myChoice === 'rock' && computerChoice === 'scissors') ||
            (myChoice === 'paper' && computerChoice === 'rock')) {

            $msg.textContent = '이겼습니다.';
            $score.textContent++;
        } else {    //졌을 때
            $msg.textContent = '졌습니다.';
        } 
    }

    const btnClick = (e) => {   //버튼 클릭 이벤트
        if (toggleBtn) {
            clearInterval(computerHand);    //이미지 멈추기
            myChoice = e.target.id; //사용자가 선택한 값
            checkGame();    //컴퓨터 값과 사용자 선택값 비교
            toggleBtn = false;  //버튼 동작 일시 정지 (멈춘 상태에서 클릭방지)
        } else {
            computerHand = setInterval(changeHand, 50); //멈춘상태에서 버튼 클릭 시 다시 가위바위보 실행
        }
    }

    let computerHand = setInterval(changeHand, 50); //0.05초마다 가위바위보 순환
    $scissors.addEventListener('click', btnClick);  //버튼별로 클릭 이벤트 부여
    $rock.addEventListener('click', btnClick);  //버튼별로 클릭 이벤트 부여
    $paper.addEventListener('click', btnClick);  //버튼별로 클릭 이벤트 부여
    
</script>
</html>